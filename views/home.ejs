<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <title>
        <%= title %>
    </title>
</head>

<body>
    <!-- <ul>
        <li>
            <% if (!user || !user.photo) { %>
                <button onclick="window.location.href='/auth/google'" title="Iniciar sesi√≥n">üîë</button>
                <% } %>
        </li>
        <li>
            <% if (user) { %>
                <button onclick="window.location.href='/logout'" title="Cerrar sesi√≥n">
                    <% if (user.photo && user.photo.trim() !=="" ) { %>
                        <img src="<%= user.photo %>" alt="Logout"
                            style="width: 28px; height: 28px; border-radius: 50%;">
                        <% } else { %>
                            <i class="fas fa-user" style="font-size: 1.2rem;"></i>
                            <% } %>
                </button>
                <% } %>
        </li>
    </ul> -->
    <!-- ********** Apartamentos recomendados ********** -->
    <div class="container">
        <h1>Bienvenidos a <%= title %>
        </h1>
        <a href="admin/apartment/new">A√±adir un nuevo apartamewnto</a>
        <br><a href="/apartments">Ver todos los apartamentos</a>
        <br><a href="/apartments/6859020e329095a063bb1a76">Ver apartamentos por id (6859020e329095a063bb1a76)</a>
        <br><a href="/apartments/search?title=Apartamento&rooms=3&price=150&maxGuests=6">Ver apartamentos por filtros
            (title = 'Apartamento', rooms = 3, price<=150, maxGuests=6)</a>
    </div>

 <main class="container">
                            <!-- ********** Formulario de b√∫squeda ********** -->
                        <div class="container">
                            <h2>Filtros</h2>
                            <form action="/apartments/search" method="GET">
                                <label for="maxGuests">Capacidad m√°xima de hu√©spedes:</label>
                                <input type="number" name="maxGuests" id="maxGuests" min="1">

                                <label for="price">Precio m√≠nimo por noche (‚Ç¨):</label>
                                <input type="number" name="price" id="price" min="0" step="0.01">

                                <label for="price">Precio m√°ximo por noche (‚Ç¨):</label>
                                <input type="number" name="price" id="price" min="0" step="0.01">

                                <label for="location.province">Provincia:</label>
                                <input type="text" name="location.province" id="locationProvince">

                                <label for="location.city">Ciudad:</label>
                                <input type="text" name="location.city" id="locationCity">

                                <label>
                                    <input type="checkbox" name="services.airConditioning" value="on">
                                    Aire Acondicionado
                                </label>

                                <label>
                                    <input type="checkbox" name="services.heating" value="on">
                                    Calefacci√≥n
                                </label>

                                <label>
                                    <input type="checkbox" name="services.accessibility" value="on">
                                    Accesibilidad
                                </label>

                                <label>
                                    <input type="checkbox" name="services.television" value="on">
                                    Televisi√≥n
                                </label>

                                <label>
                                    <input type="checkbox" name="services.kitchen" value="on">
                                    Cocina
                                </label>

                                <label>
                                    <input type="checkbox" name="services.internet" value="on">
                                    Internet
                                </label>

                                <label for="startDate">Fecha de entrada:</label>
                                <input type="date" name="startDate" id="startDate">

                                <label for="endDate">Fecha de salida:</label>
                                <input type="date" name="endDate" id="endDate">

                                <button type="submit">Buscar apartamentos</button>
                            </form>
                            <hr>

        <% if (dataApartments && dataApartments.length > 0) { %>
            <% dataApartments.forEach(function(apartment) { %>
                <article class="apartment">
                    <header>
                        <h2 style="text-align: center;">
                            <a href="/apartments/<%= apartment._id %>">
                                <%= apartment.title %>
                            </a>
                        </h2>
                    </header>
                    <% const mainPhoto = apartment.photos.find(photo => photo.isMain === true); %>
                    <% if (mainPhoto) { %>
                        <img src="<%= mainPhoto.url %>" alt="Foto principal" style="width: 100%; height: auto;">
                    <% } else { %>
                        <p>No hay foto principal disponible.</p>
                    <% } %>
                    <p><strong>Precio:</strong> <%= apartment.price %> ‚Ç¨/noche</p>
                    <p><strong>M¬≤:</strong> <%= apartment.squareMeters %> m¬≤</p>
                    <p><strong>Servicios:</strong>
                        <% if (apartment.services.airConditioning) { %> Aire Acondicionado | <% } %>
                        <% if (apartment.services.heating) { %> Calefacci√≥n | <% } %>
                        <% if (apartment.services.accessibility) { %> Accesibilidad | <% } %>
                        <% if (apartment.services.television) { %> Televisi√≥n | <% } %>
                        <% if (apartment.services.kitchen) { %> Cocina | <% } %>
                        <% if (apartment.services.internet) { %> Internet <% } %>
                    </p>
                </article>
                <hr>
            <% }); %>
        <% } else { %>
            <p>No hay apartamentos disponibles.</p>
        <% } %>
    </main>

</body>

</html>